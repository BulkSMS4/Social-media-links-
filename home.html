<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard — X-Cargo Express</title>
<style>
:root { --em-color:#ff3333; }
body { font-family:Arial,sans-serif; margin:0; padding:20px; background:#000; color:lime; }

/* --- Background overlay --- */
body::before { content:""; position:fixed; inset:0; background:#111; opacity:0.45; z-index:0; }

/* --- Mobile Screens --- */
.top-mobile { position:relative; z-index:1; width:90%; max-width:1200px; margin:20px auto; border-radius:18px; overflow:hidden; box-shadow:0 8px 30px rgba(0,0,0,0.6); }
.mobile-screen { background:#111; color:var(--em-color); padding:16px; height:280px; overflow:auto; border:3px solid rgba(255,0,0,0.25); border-radius:14px; }
.mobile-header { display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px; }
.mobile-title { font-weight:900; font-size:20px; color:var(--em-color); text-shadow:0 0 10px red; }

.post { background:#0b0b0b; border-radius:12px; padding:10px; margin-bottom:10px; color:#fff; box-shadow:0 4px 10px rgba(0,0,0,0.6); }
.post .meta { font-size:12px; color:#9fd89f; margin-bottom:6px; display:flex; justify-content:space-between; gap:8px; align-items:center; }
.post img { max-width:100%; border-radius:8px; margin-top:8px; border:1px solid #333; }
.post .download { display:inline-block; margin-top:8px; padding:8px 12px; border-radius:8px; background:#28a745; color:#fff; text-decoration:none; font-weight:700; }
.mask-link { font-weight:bold; text-decoration:underline; cursor:pointer; margin-right:6px; }

/* --- Dashboard Grid --- */
.dashboard-grid { display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-top:18px; position:relative; z-index:1; }
.dashboard-section { background:#111; border-radius:12px; padding:20px; box-shadow:0 2px 8px rgba(0,0,0,0.4); color:lime; text-align:center; }
.link-box { background:#000; padding:8px; border:1px solid lime; border-radius:6px; margin-bottom:5px; font-size:14px; word-break:break-all; color:lime; }
.link-desc { font-size:13px; color:#adff2f; margin-bottom:8px; text-align:left; }
.btn-lime { background:lime; color:black; padding:10px 12px; border-radius:8px; border:none; cursor:pointer; margin-bottom:6px; }
.btn-green { background:green; color:white; padding:10px 12px; border-radius:8px; border:none; cursor:pointer; margin-bottom:6px; }
.btn-copy { background:#333; color:lime; border:1px solid lime; padding:8px 10px; border-radius:8px; cursor:pointer; margin-bottom:6px; }

/* --- Animated Corner Ticker (different style) --- */
#cornerTicker {
  position: fixed; top:20px; right:20px; width:370px; max-width:90%; height:54px;
  background: linear-gradient(90deg, #330000, #000, #330000);
  background-size:300% 300%;
  animation:bgShift 6s linear infinite;
  color: var(--em-color);
  border:2px solid var(--em-color);
  border-radius:14px;
  display:flex; align-items:center;
  z-index:99999;
  font-weight:700; font-size:14px;
  cursor:pointer;
  box-shadow:0 0 15px red;
  overflow:hidden;
}
@keyframes bgShift { 0%{background-position:0% 50%;} 50%{background-position:100% 50%;} 100%{background-position:0% 50%;} }
#cornerTickerInner {
  display:flex; align-items:center; white-space:nowrap;
  padding-left:100%; animation: cornerScroll 12s linear infinite;
}
#cornerTickerInner img { height:32px; width:32px; object-fit:cover; border-radius:6px; margin-right:6px; }
@keyframes cornerScroll { 0%{transform:translateX(0%);} 100%{transform:translateX(-100%);} }
.hidden { display:none!important; }
</style>
</head>
<body>

<!-- Emergency Posts -->
<div class="top-mobile">
  <div class="mobile-screen" id="mobileScreen">
    <div class="mobile-header">
      <div class="mobile-title">📣 Emergency Posts ⚡</div>
    </div>
    <div id="postsList">
      <div style="color:#999;text-align:center;padding:30px 0;">Loading posts...</div>
    </div>
  </div>
</div>

<!-- Emergency Files / Tools -->
<div class="top-mobile">
  <div class="mobile-screen" id="toolsPostsScreen">
    <div class="mobile-header">
      <div class="mobile-title">🛠️ Files / Tools ⚡</div>
    </div>
    <div id="toolsPostsList">
      <div style="color:#999;text-align:center;padding:30px 0;">Loading files...</div>
    </div>
  </div>
</div>

<!-- Dashboard Sections -->
<div class="dashboard-grid">
  <div class="dashboard-section">
    <h2>🏛️ BANK 🏧</h2>
    <p class="link-desc">Copy this link and send to your client:</p>
    <div class="link-box" id="bankLink">https://bulksms4.github.io/BANKING/</div>
    <button class="btn-copy" data-copy="bankLink">📋 Copy</button>

    <p class="link-desc">Open account here:</p>
    <button class="btn-lime" data-url="https://sp0m.com">🌐 Open Account</button>

    <p class="link-desc">Credit bank account:</p>
    <button class="btn-green" data-url="https://bulksms4.github.io/BANKING/create-account.html">💵 Credit Account</button>
  </div>

  <div class="dashboard-section">
    <h2>✈️🚢 Track Package 🛍️</h2>
    <p class="link-desc">Copy this link:</p>
    <div class="link-box" id="trackLink">https://x-cargo-exprees.web.app/</div>
    <button class="btn-copy" data-copy="trackLink">📋 Copy</button>

    <p class="link-desc">Create Packages:</p>
    <button class="btn-lime" data-url="https://bulksms4.github.io/x-cargo-exprees/create.html">📦 Create Package</button>

    <p class="link-desc">Update / Suspend:</p>
    <button class="btn-green" data-url="https://bulksms4.github.io/x-cargo-exprees/update-status.html">⚠️ Update / Suspend</button>
  </div>
</div>

<!-- Animated Ticker -->
<div id="cornerTicker" title="Click for emergency link" onclick="if(emergencyLink) window.open(emergencyLink,'_blank')">
  <div id="cornerTickerInner">🚨 Loading emergency alerts...</div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<script>
// Firebase init
const firebaseConfig = {
  apiKey:"AIzaSyB5zWUvl64s6wAjjeXd0mCUyhMEdzg_MmM",
  authDomain:"usahackersland.firebaseapp.com",
  projectId:"usahackersland",
  storageBucket:"usahackersland.appspot.com",
  messagingSenderId:"588407428267",
  appId:"1:588407428267:web:7c4898cbb62efd3d5953ee"
};
if(!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();
const postsList=document.getElementById('postsList');
const toolsPostsList=document.getElementById('toolsPostsList');
const cornerTickerInner=document.getElementById('cornerTickerInner');
let emergencyLink='';

// Copy link buttons
document.querySelectorAll('.btn-copy').forEach(btn=>{
  btn.addEventListener('click',()=>{
    const id=btn.dataset.copy;
    const text=document.getElementById(id).textContent;
    navigator.clipboard.writeText(text);
    alert('Copied!');
  });
});

// Open link buttons
document.querySelectorAll('.btn-lime,.btn-green').forEach(btn=>{
  btn.addEventListener('click',()=>{
    const url=btn.dataset.url;
    if(url) window.open(url,'_blank');
  });
});

// Emergency Posts
db.collection('emergencyPosts').orderBy('createdAt','desc').onSnapshot(snapshot=>{
  postsList.innerHTML='';
  cornerTickerInner.innerHTML='';
  snapshot.forEach(doc=>{
    const d=doc.data();
    const div=document.createElement('div'); div.className='post';
    div.style.border=`2px solid ${d.color||'#ff3333'}`;
    div.innerHTML=`<div class='meta'><div>${d.author||'Admin'}</div><div>${new Date(d.createdAt?.seconds*1000||Date.now()).toLocaleString()}</div></div>
                   <div>${d.text||''}</div>`;
    if(d.imageURL){ const img=document.createElement('img'); img.src=d.imageURL; div.appendChild(img);}
    postsList.prepend(div);

    // ticker
    if(d.imageURL){ const img=document.createElement('img'); img.src=d.imageURL; cornerTickerInner.appendChild(img);}
    const span=document.createElement('span');
    span.textContent=` 🚨 ${d.text||''} 🚨 `;
    span.style.color=d.color||'#ff3333';
    cornerTickerInner.appendChild(span);
    emergencyLink=d.link||'';
  });
});

// Emergency Files — Only apk, zip, rar, pdf, docx, xlsx, txt, html
const allowedTypes=['apk','zip','rar','pdf','docx','xlsx','txt','html'];
db.collection('emergencyFiles').orderBy('createdAt','desc').onSnapshot(snapshot=>{
  toolsPostsList.innerHTML='';
  snapshot.forEach(doc=>{
    const d=doc.data();
    const div=document.createElement('div');
    div.className='post';
    div.style.border=`2px solid ${d.color||'#33ff33'}`;
    const meta=`<div class='meta'><div>${d.author||'Admin'}</div><div>${new Date(d.createdAt?.seconds*1000||Date.now()).toLocaleString()}</div></div>`;
    div.innerHTML=meta;

    if(d.title) div.innerHTML+=`<div style="font-weight:bold;margin-bottom:6px;">${d.title}</div>`;
    if(d.description) div.innerHTML+=`<div style="margin-bottom:6px;">${d.description}</div>`;

    if(Array.isArray(d.files)){
      d.files.forEach(f=>{
        if(!allowedTypes.includes(f.type)) return; // skip other types

        const a=document.createElement('a');
        a.href=f.fileURL; a.target='_blank'; a.className='download';
        let icon='⬇️';
        if(f.type==='apk') icon='📱';
        else if(['zip','rar'].includes(f.type)) icon='🗜️';
        else if(f.type==='pdf') icon='📄';
        else if(f.type==='docx'||f.type==='txt') icon='📑';
        else if(f.type==='html') icon='🌐';
        a.innerText=`${icon} Download ${f.type.toUpperCase()}`;
        div.appendChild(a);
      });
    }

    toolsPostsList.prepend(div);
  });
});
</script>
</body>
</html>
